# 更新系统
sudo apt update
sudo apt upgrade -y

# 安装必要的系统包
sudo apt install -y python3-pip python3-dev python3-venv build-essential cmake
sudo apt install -y libopencv-dev libgl1-mesa-glx libglib2.0-0
sudo apt install -y nvidia-cuda-toolkit nvidia-driver-535  # 对于RTX4060

# 验证CUDA安装
nvidia-smi
nvcc --version

# 创建虚拟环境
python3 -m venv darkvision_env
source darkvision_env/bin/activate

# 升级pip
pip install --upgrade pip

# 安装适合RTX4060的PyTorch（CUDA 11.8）
pip install torch==2.0.1+cu118 torchvision==0.15.2+cu118 torchaudio==2.0.2 --index-url https://download.pytorch.org/whl/cu118

# 安装requirements.txt中的包
pip install -r requirements.txt

# 或者逐个安装主要依赖
pip install numpy==1.24.3
pip install opencv-python==4.8.1.78
pip install Pillow==10.0.0
pip install scikit-image==0.21.0
pip install tqdm==4.65.0
pip install albumentations==1.3.1
pip install tensorboard==2.13.0
pip install wandb==0.15.8
pip install kornia==0.7.0